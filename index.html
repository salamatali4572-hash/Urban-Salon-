        <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Salon Manager</title>

  <style>
    body{margin:0;font-family:sans-serif;background:#0b1220;color:#e5e7eb;}
    header{display:flex;align-items:center;gap:10px;padding:10px 16px;background:#111;}
    header h1{margin:0;font-size:18px;font-weight:700}
    .pill{margin-left:auto;padding:4px 10px;background:#7c3aed;border-radius:999px;font-size:12px}
    .app{max-width:700px;margin:30px auto;padding:16px}
    .card{background:#1e293b;padding:20px;border-radius:14px}
    .tabs{display:flex;gap:10px;margin-bottom:16px;flex-wrap:wrap}
    .tab{flex:1;padding:10px;border-radius:8px;text-align:center;cursor:pointer;background:#334155}
    .tab.active{background:#7c3aed;color:#fff}
    .hidden{display:none}
    label{font-size:12px;display:block;margin:6px 0}
    input{width:100%;padding:10px;border-radius:8px;border:1px solid #334155;background:#0f172a;color:#fff}
    button{margin-top:8px;padding:8px 12px;border:none;border-radius:8px;background:#7c3aed;color:#fff;font-weight:700;cursor:pointer}
    ul{margin-top:10px;padding-left:18px}
    img{border-radius:6px}
  </style>
</head>
<body>
  <header>
    <div>💈</div>
    <h1>Salon Manager</h1>
    <div class="pill" id="statusPill">Closed</div>
  </header>

  <div class="app">
    <!-- AUTH -->
    <section id="auth" class="card">
      <div class="tabs">
        <div class="tab active" data-auth="login">Login</div>
        <div class="tab" data-auth="register">Register</div>
        <div class="tab" data-auth="forget">Forget Password</div>
      </div>

      <!-- Login -->
      <div id="loginPane">
        <label>Username</label><input id="loginUser" type="text" />
        <label>Password</label><input id="loginPass" type="password" />
        <button id="btnLogin">Login</button>
      </div>

      <!-- Register -->
      <div id="registerPane" class="hidden">
        <label>Username</label><input id="regUser" type="text" />
        <label>Password</label><input id="regPass" type="password" />
        <label>Owner PIN</label><input id="regPin" type="password" maxlength="6" />
        <button id="btnRegister">Create Account</button>
      </div>

      <!-- Forget Password -->
      <div id="forgetPane" class="hidden">
        <label>Username</label><input id="forUser" type="text" />
        <label>Owner PIN</label><input id="forPin" type="password" maxlength="6" />
        <label>New Password</label><input id="forNewPass" type="password" />
        <button id="btnForget">Reset Password</button>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboard" class="card hidden">
      <div class="tabs" id="mainTabs"></div>
      <div id="tabContent"></div>
      <button id="btnLogout">Logout</button>
    </section>
  </div>

  <script>
    const $ = (s, el=document)=>el.querySelector(s);
    const $$ = (s, el=document)=>Array.from(el.querySelectorAll(s));

    // ====== GLOBAL HELPERS ======
    function getUsers(){
      return JSON.parse(localStorage.getItem("users")||"[]");
    }
    function saveUsers(users){
      localStorage.setItem("users",JSON.stringify(users));
    }
    function getCurrentUser(){
      return localStorage.getItem("currentUser");
    }
    function setCurrentUser(u){
      localStorage.setItem("currentUser",u);
    }
    function logoutUser(){
      localStorage.removeItem("currentUser");
    }

    // per-user data storage
    function getData(key){
      let all=JSON.parse(localStorage.getItem("salonData")||"{}");
      let user=getCurrentUser();
      return all[user]?.[key]||[];
    }
    function saveData(key,value){
      let all=JSON.parse(localStorage.getItem("salonData")||"{}");
      let user=getCurrentUser();
      if(!all[user]) all[user]={};
      all[user][key]=value;
      localStorage.setItem("salonData",JSON.stringify(all));
    }

    // ====== AUTH SYSTEM ======
    $$('.tab[data-auth]').forEach(tab=>{
      tab.addEventListener('click', ()=>{
        $$('.tab[data-auth]').forEach(t=>t.classList.remove('active'));
        tab.classList.add('active');
        $('#loginPane').classList.toggle('hidden', tab.dataset.auth!=='login');
        $('#registerPane').classList.toggle('hidden', tab.dataset.auth!=='register');
        $('#forgetPane').classList.toggle('hidden', tab.dataset.auth!=='forget');
      });
    });

    $('#btnRegister').addEventListener('click', ()=>{
      const u=$('#regUser').value.trim();
      const p=$('#regPass').value;
      const pin=$('#regPin').value;
      if(!u||!p||!pin){alert("Fill all fields");return;}
      let users=getUsers();
      if(users.find(x=>x.u===u)){alert("User already exists");return;}
      users.push({u,p,pin});
      saveUsers(users);
      alert("Account created! Now login.");
      $('#regUser').value=$('#regPass').value=$('#regPin').value="";
      document.querySelector('[data-auth="login"]').click();
    });

    $('#btnLogin').addEventListener('click', ()=>{
      const u=$('#loginUser').value.trim();
      const p=$('#loginPass').value;
      const users=getUsers();
      const found=users.find(x=>x.u===u && x.p===p);
      if(found){
        setCurrentUser(u);
        startDashboard();
      } else {
        alert("Invalid login");
      }
    });

    $('#btnLogout').addEventListener('click', ()=>{
      logoutUser();
      $('#dashboard').classList.add("hidden");
      $('#auth').classList.remove("hidden");
      $('#statusPill').textContent="Closed";
    });

    // Forget password
    $('#btnForget').addEventListener('click', ()=>{
      const u=$('#forUser').value.trim();
      const pin=$('#forPin').value;
      const newP=$('#forNewPass').value;
      let users=getUsers();
      let found=users.find(x=>x.u===u && x.pin===pin);
      if(!found){alert("Invalid username or PIN");return;}
      found.p=newP;
      saveUsers(users);
      alert("Password reset successful. Now login.");
      $('#forUser').value=$('#forPin').value=$('#forNewPass').value="";
      document.querySelector('[data-auth="login"]').click();
    });

    // ====== DASHBOARD SYSTEM ======
    const tabs = [
      {id:"appointments", label:"Appointments"},
      {id:"billing", label:"Billing"},
      {id:"products", label:"Products & Services"},
      {id:"customers", label:"Customers"},
      {id:"sales", label:"Sales"},
      {id:"history", label:"History"}
    ];

    function startDashboard(){
      $('#auth').classList.add("hidden");
      $('#dashboard').classList.remove("hidden");
      $('#statusPill').textContent="Open";
      initTabs();
    }

    function initTabs(){
      const bar=$("#mainTabs");
      bar.innerHTML="";
      tabs.forEach(t=>{
        const b=document.createElement("div");
        b.className="tab";
        b.textContent=t.label;
        b.onclick=()=>openTab(t.id);
        bar.appendChild(b);
      });
      openTab("appointments");
    }

    function openTab(id){
      $$("#mainTabs .tab").forEach(b=>b.classList.remove("active"));
      const idx=tabs.findIndex(t=>t.id===id);
      $$("#mainTabs .tab")[idx].classList.add("active");
      const box=$("#tabContent");
      box.innerHTML="";
      switch(id){
        case "appointments": renderAppointments(box); break;
        case "billing": renderBilling(box); break;
        case "products": renderProducts(box); break;
        case "customers": renderCustomers(box); break;
        case "sales": renderSales(box); break;
        case "history": renderHistory(box); break;
      }
    }

    // ====== APPOINTMENTS ======
    function renderAppointments(el){
      el.innerHTML=`
        <h3>Book Appointment</h3>
        <label>Name</label><input id="aptName" type="text">
        <label>Service</label><input id="aptService" type="text">
        <label>Date & Time</label><input id="aptTime" type="datetime-local">
        <button id="saveApt">Save</button>
        <ul id="aptList"></ul>
      `;
      $("#saveApt").onclick=()=>{
        let apts=getData("apts");
        apts.push({name:$("#aptName").value,service:$("#aptService").value,time:$("#aptTime").value});
        saveData("apts",apts);
        openTab("appointments");
      };
      let apts=getData("apts");
      $("#aptList").innerHTML=apts.map(a=>`<li>${a.name} - ${a.service} at ${a.time}</li>`).join("");
    }

    // ====== BILLING ======
    function renderBilling(el){
      let prods=getData("prods");
      el.innerHTML=`
        <h3>Walk-in Billing</h3>
        <label>Customer</label><input id="billName" type="text">
        <label>Phone (WhatsApp)</label><input id="billPhone" type="text">

        <h4>Select Products/Services</h4>
        <div id="billProducts">
          ${prods.map((p,i)=>`
            <div>
              <input type="checkbox" class="billProd" data-index="${i}" data-price="${p.price}" data-name="${p.name}">
              ${p.name} - $${p.price}
            </div>
          `).join("")}
        </div>

        <p><b>Total: $<span id="billTotal">0</span></b></p>
        <button id="saveBill">Save Bill</button>
        <ul id="billList"></ul>
      `;

      function updateTotal(){
        let total=0;
        $$(".billProd:checked").forEach(c=>{total+=+c.dataset.price});
        $("#billTotal").textContent=total;
      }
      $$(".billProd").forEach(c=>c.addEventListener("change",updateTotal));

      $("#saveBill").onclick=()=>{
        let bills=getData("bills");
        let selected=[];
        let total=0;
        $$(".billProd:checked").forEach(c=>{
          selected.push({name:c.dataset.name,price:+c.dataset.price});
          total+=+c.dataset.price;
        });
        if(!selected.length){alert("Select at least one item");return;}
        let bill={name:$("#billName").value,phone:$("#billPhone").value,items:selected,amt:total,time:new Date().toLocaleString()};
        bills.push(bill);
        saveData("bills",bills);
        let dayTotal=+getData("totalSale")||0;
        saveData("totalSale",dayTotal+bill.amt);
        openTab("billing");
      };

      let bills=getData("bills");
      $("#billList").innerHTML=bills.map((b,i)=>`
        <li>
          <b>${b.name}</b> - $${b.amt}<br>
          <small>${b.time}</small><br>
          <button onclick="printReceipt(${i})">🖨 Print</button>
          <button onclick="sendWhatsApp(${i})">📲 WhatsApp</button>
        </li>
      `).join("");
    }

    function printReceipt(index){
      let bills=getData("bills");
      let b=bills[index];
      let itemsHtml=b.items.map(it=>`<li>${it.name} - $${it.price}</li>`).join("");
      let w=window.open("","","width=400,height=600");
      w.document.write(`
        <h2>Salon Receipt</h2>
        <p><b>Customer:</b> ${b.name}</p>
        <ul>${itemsHtml}</ul>
        <p><b>Total:</b> $${b.amt}</p>
        <p><b>Date:</b> ${b.time}</p>
        <hr>
        <p>Thank you for visiting!</p>
      `);
      w.print();
      w.close();
    }

    function sendWhatsApp(index){
      let bills=getData("bills");
      let b=bills[index];
      if(!b.phone){alert("No phone number saved");return;}
      let itemsText=b.items.map(it=>`${it.name} - $${it.price}`).join("%0a");
      let msg=`Hello ${b.name},%0aYour bill:%0a${itemsText}%0aTotal: $${b.amt}%0aDate: ${b.time}%0aThank you for visiting our salon!`;
      let url=`https://wa.me/${b.phone}?text=${msg}`;
      window.open(url,"_blank");
    }

    // ====== PRODUCTS ======
    function renderProducts(el){
      el.innerHTML=`
        <h3>Products & Services</h3>
        <label>Name</label><input id="prodName" type="text">
        <label>Price</label><input id="prodPrice" type="number">
        <label>Photo URL (optional)</label><input id="prodPhoto" type="text">
        <label>Or Upload Photo</label><input id="prodFile" type="file" accept="image/*">
        <button id="saveProd">Save Product</button>
        <div id="prodList"></div>
      `;
      let editingIndex=null;
      $("#saveProd").onclick=()=>{
        let prods=getData("prods");
        let file=$("#prodFile").files[0];
        let name=$("#prodName").value;
        let price=+$("#prodPrice").value;
        let url=$("#prodPhoto").value;
        function saveDataNow(photo){
          if(editingIndex!==null){
            prods[editingIndex]={name,price,photo};
            editingIndex=null;
          }else{
            prods.push({name,price,photo});
          }
          saveData("prods",prods);
          openTab("products");
        }
        if(file){
          let reader=new FileReader();
          reader.onload=(e)=>saveDataNow(e.target.result);
          reader.readAsDataURL(file);
        }else{
          saveDataNow(url);
        }
      };
      let prods=getData("prods");
      $("#prodList").innerHTML=prods.map((p,i)=>`
        <div style="margin:6px 0;padding:6px;border:1px solid #333;border-radius:6px;display:flex;align-items:center;gap:10px;">
          <img src="${p.photo}" width="50" height="50">
          <div style="flex:1">${p.name} - $${p.price}</div>
          <button onclick="editProduct(${i})">✏️ Edit</button>
          <button onclick="deleteProduct(${i})">❌ Delete</button>
        </div>
      `).join("");
      window.editProduct=(i)=>{
        let prods=getData("prods");
        let p=prods[i];
        $("#prodName").value=p.name;
        $("#prodPrice").value=p.price;
        $("#prodPhoto").value=p.photo.startsWith("data:")?"":p.photo;
        $("#prodFile").value="";
        editingIndex=i;
      };
      window.deleteProduct=(i)=>{
        let prods=getData("prods");
        prods.splice(i,1);
        saveData("prods",prods);
        openTab("products");
      };
    }

    // ====== CUSTOMERS ======
    function renderCustomers(el){
      el.innerHTML=`
        <h3>Save Customer Info</h3>
        <label>Name</label><input id="custName" type="text">
        <label>Phone</label><input id="custPhone" type="text">
        <button id="saveCust">Save Customer</button>
        <ul id="custList"></ul>
      `;
      $("#saveCust").onclick=()=>{
        let custs=getData("custs");
        custs.push({name:$("#custName").value,phone:$("#custPhone").value});
        saveData("custs",custs);
        openTab("customers");
      };
      let custs=getData("custs");
      $("#custList").innerHTML=custs.map(c=>`<li>${c.name} (${c.phone})</li>`).join("");
    }

    // ====== SALES ======
    function renderSales(el){
      let total=+getData("totalSale")||0;
      el.innerHTML=`
        <h3>Today's Sales</h3>
        <p>Total: $${total}</p>
        <button id
